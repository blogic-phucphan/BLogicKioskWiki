---
import { SITE } from "src/config";
import Hr from "./Hr.astro";
import LinkButton from "./LinkButton.astro";

export interface Props {
  activeNav?: "posts" | "tags" | "about" | "search";
}

const { activeNav } = Astro.props;
---

<header>
  <a id="skip-to-content" href="#main-content">Skip to content</a>
  <div class="nav-container">
    <div class="top-nav-wrap">
      <a href="/" class="logo">
        <!-- bls-logo -->
        <svg class="h-9 w-auto" version="1.1" viewBox="0 0 1020 284" xmlns="http://www.w3.org/2000/svg">
          <path fill="var(--blogic-logo-title-color)" d="m281.18 195.06c-5.542 0-10.252 1.3732-13.67 3.9492-1.8473 1.288-3.2326 2.9195-4.1562 4.8086-1.016 1.8891-1.5703 4.035-1.5703 6.2676 0 2.8336 0.64689 5.2379 1.8477 7.2129 1.2007 1.8891 2.8619 3.4365 4.9863 4.5528 3.6946 2.0608 8.4989 2.8327 13.117 3.6055 10.345 1.6315 16.717 3.1771 16.717 12.107 0 3.6064-1.6615 6.9552-4.6172 9.5312-3.2328 2.7478-7.7589 4.207-12.654 4.207-6.2809 0-12.193-2.232-16.996-6.5254-1.016-0.85868-2.5855-0.85854-3.6016 0.0859-0.92365 0.94454-0.92424 2.405 0.0918 3.3496 5.819 5.1521 12.839 7.8125 20.506 7.8125 6.1885 0 11.916-1.8876 16.072-5.4082 4.0641-3.4347 6.373-8.0724 6.373-13.053 0-3.0912-0.74011-5.7538-2.0332-7.9863-1.1084-1.975-2.8627-3.6924-5.1719-4.9805-3.9717-2.2326-8.9601-3.0046-13.855-3.8633-4.3412-0.68693-8.496-1.3743-11.359-2.9199-2.9557-1.6315-4.25-4.0362-4.25-7.7285 0-3.0054 1.2014-5.5815 3.6953-7.3848 2.5862-1.8891 6.1881-2.918 10.529-2.918 4.9878 0 10.161 1.3731 14.225 3.7773 1.2008 0.68695 2.7708 0.34285 3.5098-0.77343s0.36872-2.5748-0.83203-3.2617c-4.803-2.8336-10.991-4.4648-16.902-4.4648zm54.07 0c-0.49089-4e-3 -0.99308 0.12567-1.4434 0.39452-1.1084 0.71681-1.4792 2.2395-0.74024 3.4043l22.262 32.795v21.953c0 1.344 1.1067 2.418 2.4922 2.418s2.5879-1.074 2.5879-2.418v-21.953l22.166-32.795c0.8313-1.1648 0.46247-2.6875-0.73829-3.4043-1.1084-0.71683-2.6785-0.44802-3.5098 0.71681l-20.506 30.285-20.504-30.285c-0.46183-0.72802-1.2483-1.1052-2.0664-1.1113zm98.609 0c-5.542 0-10.252 1.3732-13.67 3.9492-1.8473 1.288-3.2326 2.9195-4.1563 4.8086-1.016 1.8891-1.5703 4.035-1.5703 6.2676 0 2.8336 0.6469 5.2379 1.8476 7.2129 1.2008 1.8891 2.8619 3.4365 4.9863 4.5528 3.6946 2.0608 8.4989 2.8326 13.117 3.6055 10.345 1.6315 16.719 3.1772 16.719 12.107 0 3.6065-1.6634 6.9552-4.6191 9.5312-3.2328 2.7478-7.7589 4.207-12.654 4.207-6.2809 0-12.191-2.232-16.994-6.5254-1.016-0.85868-2.5875-0.85854-3.6035 0.0859-0.92364 0.94455-0.92423 2.405 0.0918 3.3496 5.819 5.1521 12.839 7.8125 20.506 7.8125 6.1885 0 11.916-1.8876 16.072-5.4082 4.0641-3.4347 6.373-8.0724 6.373-13.053 0-3.0912-0.73814-5.7538-2.0313-7.9863-1.1084-1.975-2.8647-3.6925-5.1738-4.9805-3.9717-2.2326-8.9601-3.0046-13.855-3.8633-4.3412-0.68694-8.496-1.3743-11.359-2.9199-2.9557-1.6315-4.25-4.0362-4.25-7.7285 0-3.0054 1.2014-5.5815 3.6953-7.3848 2.5862-1.8891 6.1881-2.918 10.529-2.918 4.9878 0 10.161 1.3731 14.225 3.7773 1.2008 0.68696 2.7708 0.34287 3.5098-0.77343 0.73891-1.1163 0.36873-2.5748-0.83204-3.2617-4.803-2.8336-10.991-4.4648-16.902-4.4648zm56.631 0c-1.3855 0-2.5859 1.0751-2.5859 2.4199 0 1.4345 1.2004 2.5098 2.5859 2.5098h17.088v53.615c0 1.3448 1.1086 2.4199 2.4941 2.4199 1.4778 0 2.5859-1.0751 2.5859-2.4199v-53.615h17.088c1.3855 0 2.4941-1.0753 2.4941-2.5098 0-1.3449-1.1086-2.4199-2.4941-2.4199zm77.631 0c-1.4376 0-2.6836 1.0752-2.6836 2.5098v55.945c0 1.4345 1.246 2.5098 2.6836 2.5098h33.066c1.4376 0 2.5879-1.0753 2.5879-2.5098 0-1.3448-1.1503-2.4199-2.5879-2.4199h-30.479v-23.133h26.645c1.4376 0 2.5879-1.0751 2.5879-2.4199 0-1.3448-1.1503-2.5098-2.5879-2.5098h-26.645v-23.043h28.561c1.4376 0 2.5879-1.0751 2.5879-2.4199 0-1.4345-1.1503-2.5098-2.5879-2.5098zm72.445 0c-0.238-6e-3 -0.47741 0.0334-0.70507 0.12303-0.9934 0.26881-1.6543 1.2548-1.6543 2.3301v56.004c0 1.3441 0.99262 2.5078 2.2344 2.5078 1.3246 0 2.3184-1.1637 2.3184-2.5078v-47.492l19.785 33.781c0.41392 0.71687 1.1592 1.166 1.9043 1.166 0.82783 0 1.5724-0.44915 1.9863-1.166l19.787-33.781v47.492c0 1.3441 0.99259 2.5078 2.2344 2.5078 1.3246 0 2.3184-1.1637 2.3184-2.5078v-56.004c0-1.0753-0.66284-2.0613-1.6562-2.3301-0.99342-0.35844-1.9869 0.0903-2.5664 0.98633l-22.104 37.723-22.021-37.723c-0.4346-0.67206-1.1473-1.0926-1.8613-1.1094zm99.441 0c-5.542 0-10.252 1.3732-13.67 3.9492-1.8473 1.288-3.2326 2.9195-4.1562 4.8086-1.016 1.8891-1.5703 4.035-1.5703 6.2676 0 2.8336 0.64692 5.2379 1.8477 7.2129 1.2008 1.8891 2.8619 3.4365 4.9863 4.5528 3.6946 2.0608 8.4989 2.8326 13.117 3.6055 10.345 1.6315 16.719 3.1772 16.719 12.107 0 3.6065-1.6634 6.9552-4.6191 9.5312-3.2328 2.7478-7.7589 4.207-12.654 4.207-6.2809 0-12.191-2.232-16.994-6.5254-1.016-0.85868-2.5875-0.85854-3.6035 0.0859-0.92365 0.94455-0.92424 2.405 0.0918 3.3496 5.819 5.1521 12.839 7.8125 20.506 7.8125 6.1885 0 11.916-1.8876 16.072-5.4082 4.0641-3.4347 6.373-8.0724 6.373-13.053 0-3.0912-0.73814-5.7538-2.0312-7.9863h-1e-3c-1.1084-1.975-2.8627-3.6925-5.1719-4.9805-3.9717-2.2326-8.9601-3.0046-13.855-3.8633-4.3412-0.68694-8.496-1.3743-11.359-2.9199-2.9557-1.6315-4.25-4.0362-4.25-7.7285 0-3.0054 1.2014-5.5815 3.6953-7.3848 2.5863-1.8891 6.1881-2.918 10.529-2.918 4.9878 0 10.161 1.3731 14.225 3.7773 1.2008 0.68696 2.7708 0.34287 3.5098-0.77343 0.73893-1.1163 0.36872-2.5748-0.83203-3.2617-4.803-2.8336-10.991-4.4648-16.902-4.4648z"/>
          <path fill="var(--blogic-logo-sub-title-color)" d="m99.662 27.975c-1.8571 0-3.5821 0.28274-5.1738 0.8496-1.5918 0.56686-2.9839 1.3605-4.1777 2.3809-1.1275 1.0204-2.0223 2.2118-2.6856 3.5723-0.66323 1.3605-0.9961 2.8054-0.9961 4.3359v99.654c0 1.5872 0.33286 3.0614 0.9961 4.4219 0.66325 1.3605 1.5581 2.55 2.6856 3.5703 1.1938 0.96368 2.586 1.73 4.1777 2.2969 1.5918 0.56687 3.3168 0.84961 5.1738 0.84961h98.191c5.7701 0 10.646-0.8775 14.625-2.6348 3.9794-1.814 7.1964-4.0545 9.6504-6.7187 2.5203-2.6643 4.3099-5.5541 5.3711-8.6719 1.1275-3.1178 1.6914-6.0369 1.6914-8.7578v-4.2519c0-4.3082-0.5639-8.2471-1.6914-11.818-1.1275-3.5712-2.6528-6.775-4.5762-9.6094-1.9234-2.8343-4.179-5.3283-6.7656-7.4824-2.5203-2.1541-5.238-3.9968-8.1562-5.5273 3.3825-4.0247 5.8359-8.2757 7.3613-12.754 1.5254-4.5349 2.2871-8.7586 2.2871-12.67v-4.166c0-4.9317-1.0612-9.0988-3.1836-12.5-2.056-3.4012-4.6739-6.1506-7.8574-8.248-3.1172-2.1541-6.5007-3.7121-10.148-4.6758-3.6478-0.96368-7.0626-1.4453-10.246-1.4453zm153.11 0v110.79c0 1.5872 0.29861 3.0614 0.89258 4.4219 0.59398 1.3605 1.3946 2.55 2.4043 3.5703 1.0691 0.96366 2.3167 1.73 3.7422 2.2969 1.4255 0.56688 2.9697 0.85987 4.6328 0.84961l119.92-0.69531v-22.107l-108.43 0.6953v-99.824zm205.02 0c-8.5811 0-16.53 1.241-23.848 3.7226s-13.635 5.928-18.957 10.34c-5.3216 4.3567-9.5124 9.5954-12.572 15.717-2.9934 6.0663-4.4902 12.684-4.4902 19.854v22.666c0 7.2244 1.4968 13.869 4.4902 19.936 3.0599 6.0663 7.2507 11.305 12.572 15.717 5.3216 4.4118 11.64 7.8601 18.957 10.342 7.3172 2.4265 15.267 3.6387 23.848 3.6387h35.123c8.5811 0 16.497-1.2122 23.748-3.6387 7.3172-2.4817 13.635-5.93 18.957-10.342 5.3216-4.4119 9.4793-9.6505 12.473-15.717 2.9934-6.0663 4.4902-12.711 4.4902-19.936v-22.666c0-7.1693-1.4968-13.787-4.4902-19.854-2.9934-6.1215-7.1511-11.36-12.473-15.717-5.3216-4.4119-11.64-7.8582-18.957-10.34-7.2507-2.4817-15.167-3.7226-23.748-3.7226zm156.28 3.3086c-4.4378 0-8.4134 0.46873-11.924 1.4063-3.5104 0.93751-6.6222 2.2054-9.3379 3.8047-2.6494 1.5441-4.9347 3.3365-6.8555 5.377-1.9208 2.0405-3.4777 4.1921-4.6699 6.4531-1.1922 2.2059-2.0855 4.467-2.6816 6.7832-0.52987 2.2611-0.79492 4.3838-0.79492 6.3691v58.236c0 3.6949 0.56149 7.0318 1.6875 10.01 1.126 2.9229 2.6161 5.5143 4.4707 7.7754 1.9208 2.2059 4.1079 4.1097 6.5586 5.709 2.4507 1.5441 5.001 2.812 7.6504 3.8047 2.7156 0.99266 5.4308 1.7361 8.1465 2.2324 2.7819 0.44119 5.3655 0.66211 7.75 0.66211h93.193c1.8546 0 3.5764-0.27469 5.166-0.82617 1.5896-0.55148 2.9462-1.2968 4.0723-2.2344 1.1922-0.99266 2.1208-2.151 2.7832-3.4746 0.66234-1.3236 0.99219-2.7566 0.99219-4.3008v-48.475c0-1.489-0.32985-2.8683-0.99219-4.1367-0.66236-1.3236-1.591-2.482-2.7832-3.4746-1.126-0.99268-2.4826-1.7649-4.0723-2.3164-1.5897-0.60663-3.3114-0.91017-5.166-0.91017h-81.57v21.674h68.754v26.967h-80.377c-3.3118 0-5.8954-0.74342-7.75-2.2324-1.7884-1.5442-2.6836-3.6957-2.6836-6.4531v-58.07c0-2.9228 0.89524-5.1301 2.6836-6.6191 1.7884-1.489 4.372-2.2324 7.75-2.2324h105.02v-21.508zm134.03 0v118.62h26.379v-118.62zm91.145 0c-4.4825 0-8.4971 0.46873-12.043 1.4063-3.5459 0.93751-6.6906 2.2054-9.4336 3.8047-2.6761 1.5442-4.9836 3.3365-6.9238 5.377-1.9402 2.0405-3.5125 4.1921-4.7168 6.4531-1.2043 2.2059-2.1088 4.467-2.7109 6.7832-0.53523 2.2611-0.80273 4.3838-0.80273 6.3691v58.236c0 3.6949 0.56967 7.0318 1.707 10.01 1.1374 2.9229 2.6423 5.5143 4.5156 7.7754 1.9402 2.2059 4.1476 4.1097 6.623 5.709 2.4754 1.5441 5.0524 2.812 7.7285 3.8047 2.743 0.99266 5.4855 1.7361 8.2285 2.2324 2.8099 0.44119 5.4196 0.66211 7.8281 0.66211h94.133v-21.508h-94.133c-3.3452 0-5.9548-0.74342-7.8281-2.2324-1.8064-1.5442-2.709-3.6957-2.709-6.4531v-58.07c0-2.9228 0.9026-5.1301 2.709-6.6191 1.8064-1.489 4.416-2.2324 7.8281-2.2324h94.133v-21.508zm-381.46 18.199h35.123c4.989 0 9.5457 0.68964 13.67 2.0683 4.1908 1.3236 7.7489 3.2254 10.676 5.707 2.9934 2.4265 5.2883 5.3772 6.8848 8.8516 1.663 3.4192 2.4941 7.2516 2.4941 11.498v22.666c0 4.2464-0.83112 8.1077-2.4941 11.582-1.5965 3.4192-3.8914 6.3679-6.8848 8.8496-2.9934 2.4265-6.5846 4.3303-10.775 5.709-4.1242 1.3236-8.714 1.9844-13.77 1.9844h-34.924c-5.0555 0-9.6784-0.66081-13.869-1.9844-4.1242-1.3787-7.6824-3.2825-10.676-5.709-2.9934-2.4817-5.3233-5.4304-6.9863-8.8496-1.5965-3.4743-2.3945-7.3356-2.3945-11.582v-22.666c0-4.2464 0.79806-8.0789 2.3945-11.498 1.663-3.4743 3.9929-6.425 6.9863-8.8516 2.9934-2.4817 6.5515-4.3835 10.676-5.707 4.1908-1.3787 8.8136-2.0683 13.869-2.0683zm-345.29 0.59961h73.719c3.5814 0 5.3711 1.5873 5.3711 4.7617v4.166c0 2.891-0.53063 5.4981-1.5918 7.8223-0.99485 2.2675-2.4536 4.2233-4.377 5.8672-1.9234 1.6439-4.2456 2.9192-6.9649 3.8262-2.7192 0.85028-5.7698 1.2754-9.1523 1.2754h-46.658v22.279h58.299c3.3825 0 6.4331 0.45239 9.1524 1.3594 2.7192 0.85029 5.0415 2.0983 6.9648 3.7422 1.9234 1.6439 3.4154 3.627 4.4766 5.9512 1.0612 2.2675 1.5918 4.8473 1.5918 7.7383v4.082c0 1.1904-0.19971 2.1244-0.59765 2.8047-0.39793 0.68024-0.86198 1.1619-1.3926 1.4453-0.53056 0.2835-1.1278 0.45511-1.791 0.51171-0.66324 0.0568-1.2272 0.084-1.6914 0.084h-85.357z"/>
        </svg>
      </a>
      <nav id="nav-menu">
        <button
          class="hamburger-menu focus-outline"
          aria-label="Open Menu"
          aria-expanded="false"
          aria-controls="menu-items"
        >
          <div class="icon-container flex">
            <div id="first-line"></div>
            <div id="second-line"></div>
            <div id="third-line"></div>
          </div>
        </button>
        <ul id="menu-items" class="display-none sm:flex">
          <li>
            <a href="/posts" class={activeNav === "posts" ? "active" : ""}>
              Posts
            </a>
          </li>
          <li>
            <LinkButton
              href="/search"
              className={`focus-outline p-3 sm:p-1 ${
                activeNav === "search" ? "active" : ""
              }`}
              ariaLabel="search"
              title="Search"
            >
              <svg xmlns="http://www.w3.org/2000/svg" class="scale-125 sm:scale-100">
                <path d="M19.023 16.977a35.13 35.13 0 0 1-1.367-1.384c-.372-.378-.596-.653-.596-.653l-2.8-1.337A6.962 6.962 0 0 0 16 9c0-3.859-3.14-7-7-7S2 5.141 2 9s3.14 7 7 7c1.763 0 3.37-.66 4.603-1.739l1.337 2.8s.275.224.653.596c.387.363.896.854 1.384 1.367l1.358 1.392.604.646 2.121-2.121-.646-.604c-.379-.372-.885-.866-1.391-1.36zM9 14c-2.757 0-5-2.243-5-5s2.243-5 5-5 5 2.243 5 5-2.243 5-5 5z"></path>
              </svg>
            </LinkButton>
          </li>
          <li>
            {
              SITE.lightAndDarkMode && (
                <button
                  id="theme-btn"
                  class="focus-outline"
                  title="Toggles light & dark"
                  aria-label="auto"
                  aria-live="polite"
                >
                  <svg xmlns="http://www.w3.org/2000/svg" id="moon-svg">
                    <path d="M20.742 13.045a8.088 8.088 0 0 1-2.077.271c-2.135 0-4.14-.83-5.646-2.336a8.025 8.025 0 0 1-2.064-7.723A1 1 0 0 0 9.73 2.034a10.014 10.014 0 0 0-4.489 2.582c-3.898 3.898-3.898 10.243 0 14.143a9.937 9.937 0 0 0 7.072 2.93 9.93 9.93 0 0 0 7.07-2.929 10.007 10.007 0 0 0 2.583-4.491 1.001 1.001 0 0 0-1.224-1.224zm-2.772 4.301a7.947 7.947 0 0 1-5.656 2.343 7.953 7.953 0 0 1-5.658-2.344c-3.118-3.119-3.118-8.195 0-11.314a7.923 7.923 0 0 1 2.06-1.483 10.027 10.027 0 0 0 2.89 7.848 9.972 9.972 0 0 0 7.848 2.891 8.036 8.036 0 0 1-1.484 2.059z" />
                  </svg>
                  <svg xmlns="http://www.w3.org/2000/svg" id="sun-svg">
                    <path d="M6.993 12c0 2.761 2.246 5.007 5.007 5.007s5.007-2.246 5.007-5.007S14.761 6.993 12 6.993 6.993 9.239 6.993 12zM12 8.993c1.658 0 3.007 1.349 3.007 3.007S13.658 15.007 12 15.007 8.993 13.658 8.993 12 10.342 8.993 12 8.993zM10.998 19h2v3h-2zm0-17h2v3h-2zm-9 9h3v2h-3zm17 0h3v2h-3zM4.219 18.363l2.12-2.122 1.415 1.414-2.12 2.122zM16.24 6.344l2.122-2.122 1.414 1.414-2.122 2.122zM6.342 7.759 4.22 5.637l1.415-1.414 2.12 2.122zm13.434 10.605-1.414 1.414-2.122-2.122 1.414-1.414z" />
                  </svg>
                </button>
              )
            }
          </li>
        </ul>
      </nav>
    </div>
  </div>
  <Hr />
</header>

<style>
  #skip-to-content {
    @apply bg-skin-accent text-skin-inverted py-2 px-3 absolute -top-full focus:top-4 left-16 z-50 transition-all;
  }
  .nav-container {
    @apply max-w-3xl mx-auto flex flex-col sm:flex-row justify-between items-center;
  }
  .top-nav-wrap {
    @apply relative w-full p-4 sm:py-8 flex justify-between items-start sm:items-center;
  }
  .logo {
    @apply absolute sm:static font-semibold text-xl sm:text-2xl py-1;
  }
  .hamburger-menu {
    @apply self-end p-2 sm:hidden;
  }
  .hamburger-menu svg {
    @apply fill-skin-base w-6 h-6 scale-125;
  }

  nav {
    @apply w-full sm:py-0 sm:ml-2 flex flex-col items-center sm:justify-end sm:flex-row sm:space-x-4 bg-skin-fill;
  }
  nav ul {
    @apply mt-4 w-44 grid grid-rows-4 grid-cols-2 gap-y-2 gap-x-2 sm:gap-y-0 sm:mt-0 sm:ml-0 sm:w-auto sm:gap-x-5;
  }
  nav ul li {
    @apply col-span-2 flex justify-center items-center;
  }
  nav ul li a {
    @apply px-4 py-3 w-full text-center sm:px-2 sm:py-1 sm:my-0 font-medium hover:text-skin-accent;
  }
  nav ul li:nth-child(4) a {
    @apply w-auto;
  }
  nav ul li:nth-child(4),
  nav ul li:nth-child(5) {
    @apply col-span-1;
  }
  nav a.active {
    @apply underline underline-offset-4 decoration-wavy decoration-2;
  }
  nav a.active svg {
    @apply fill-skin-accent;
  }

  nav button {
    @apply p-1;
  }
  nav button svg {
    @apply w-6 h-6 fill-skin-base hover:fill-skin-accent;
  }
  #theme-btn {
    @apply p-3 sm:p-1;
  }
  #theme-btn svg {
    @apply hover:rotate-12 scale-125 sm:scale-100;
  }

  .icon-container {
    @apply w-6 h-5 flex-col justify-between items-end;
  }
  .icon-container div {
    @apply bg-skin-inverted h-0.5 transition-all;
  }
  #first-line {
    @apply w-full;
  }
  #second-line {
    @apply w-3/4;
  }
  #third-line {
    @apply w-1/2;
  }
</style>

<script>
  // Toggle menu
  const menuBtn = document.querySelector(".hamburger-menu");
  const menuItems = document.querySelector("#menu-items")?.classList;

  const iconContainer = document.querySelector(".icon-container")?.classList;
  const firstLine = document.querySelector("#first-line")?.classList;
  const secondLine = document.querySelector("#second-line ")?.classList;
  const thirdLine = document.querySelector("#third-line")?.classList;

  menuBtn!.addEventListener("click", function (event) {
    const menuExpanded = menuBtn?.getAttribute("aria-expanded");
    if (menuExpanded === "false") {
      menuBtn?.setAttribute("aria-expanded", "true");
      menuBtn?.setAttribute("aria-label", "Close Menu");
      menuItems?.remove("display-none");

      // icon animation
      iconContainer?.remove("flex");
      iconContainer?.add("relative");
      firstLine?.add("rotate-45", "absolute", "bottom-1/2");
      thirdLine?.add("display-none");
      secondLine?.add("!w-full", "-rotate-45", "absolute", "bottom-1/2");
    } else {
      menuBtn?.setAttribute("aria-expanded", "false");
      menuBtn?.setAttribute("aria-label", "Open Menu");
      menuItems?.add("display-none");

      // icon animation
      iconContainer?.add("flex");
      iconContainer?.remove("relative");
      firstLine?.remove("rotate-45", "absolute", "bottom-1/2");
      thirdLine?.remove("display-none");
      secondLine?.remove("!w-full", "-rotate-45", "absolute", "bottom-1/2");
    }
  });
</script>
